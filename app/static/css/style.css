/* =========================================================
 * AURUM UI — Clean Override (v2025-09-09b)
 * 修正：
 * 1) 基底 input 不再影響 checkbox（避免 40px 長方形）
 * 2) checkbox 強制正方形：aspect-ratio、寬高 14、padding 0
 * 3) 表格/拖曳等設計同前版
 * =======================================================*/

/* ============== 變數 ============== */
:root{
  --line:#E5D7B2; --line-soft:#EFE6C9; --text:#1F2430;
  --shadow:0 10px 25px rgba(15,23,42,.06);
  --primary:#2f66f5; --danger:#ef4444;
  --rg1:#fffaf6; --rg2:#fbeee6; --rg3:#f7e5dc;
  --gold-50:#FFF1BF; --gold-100:#FFE08C;   /* 早班 */
  --blue-50:#E6EAFF; --blue-100:#CCD6FF;   /* 晚班 */
  --red-50:#FFDADF;                         /* 支出 */
  --green-50:#EAFEF2;                       /* 總額 */
  --lavender-50:#EDE6FF;                    /* 扣支出後 */
}

/* ============== 全域 ============== */
*{ box-sizing:border-box; }
html,body{
  margin:0; padding:0; color:#1f2937;
  font-family:system-ui,-apple-system,"Segoe UI","Noto Sans TC","Microsoft JhengHei",sans-serif;
  background:
    radial-gradient(1200px 300px at 10% -10%, rgba(255,255,255,.75), transparent 60%),
    radial-gradient(900px 260px at 95% 0%,   rgba(255,255,255,.55), transparent 60%),
    linear-gradient(135deg, var(--rg1), var(--rg2) 40%, var(--rg3));
}
a{ color:inherit; text-decoration:none; }
.center{ text-align:center; }

/* 版面 */
.app{ display:flex; }
.sidebar{ width:240px; min-height:100vh; background:#fff; border-right:1px solid var(--line); }
.main{ flex:1; min-height:100vh; padding:0 6px; }
.content{ padding:16px; }
.content.tight{ padding:14px 18px 16px; }

/* 登入頁模式 */
.app.auth-only .sidebar{ display:none; }
.content.auth-center{ padding:0; }

/* 品牌 */
.brand{ padding:14px 12px 10px; text-align:center; }
.nowrap{ white-space:nowrap; }
.brand-title{ font-weight:900; font-size:18px; }
.brand-sub{ font-weight:800; color:#334155; margin-top:2px; }

/* 側欄導航 */
.nav{ display:flex; flex-direction:column; gap:6px; padding:8px; }
.nav-item{
  padding:10px 12px; margin:0 6px; border:1px solid transparent;
  border-radius:12px; transition:background .15s ease,border-color .15s ease;
}
.nav-item:hover{ background:#f6f9ff; }
.nav-item.active{ background:#f3f6ff; border-color:var(--line-soft); font-weight:700; }
.sidebar .nav-item{ font-size:15px; }

/* 卡片 / 表單元件 */
.card{
  background:#fff; border:1px solid var(--line); border-radius:18px;
  padding:16px; box-shadow:var(--shadow); margin-bottom:16px;
}
.btn{
  display:inline-flex; align-items:center; justify-content:center;
  height:40px; padding:0 16px; border-radius:12px; border:1px solid var(--line);
  background:#fff; cursor:pointer; white-space:nowrap;
}
.btn.primary{ background:var(--primary); color:#fff; border-color:var(--primary); }
.btn.danger{ background:var(--danger); color:#fff; border-color:var(--danger); }
.btn.pill{ border-radius:999px; }

/* ！！！關鍵修正：排除 checkbox ！！！ */
.input,
input:not([type="checkbox"]),
select,
textarea{
  height:40px; padding:0 12px; border:1px solid var(--line);
  border-radius:12px; background:#fff;
}
select{ appearance:auto; }

/* 工具列（搜尋 / 新增）—輕量卡片 */
.card.toolbar, .toolbar, .order-create, .page-header, .page-toolbar, .filters, .filter-bar, .search-bar{
  background:rgba(255,255,255,.75); border:1px solid var(--line-soft);
  border-radius:16px; box-shadow:0 6px 18px rgba(15,23,42,.05);
  padding:10px 12px; margin-bottom:10px;
}
.toolbar{ display:flex; align-items:center; gap:12px; flex-wrap:wrap; }
.toolbar .row, .order-create .row{ display:flex; align-items:center; gap:8px; }

/* 操作列/訊息 */
.actionbar{ display:flex; gap:10px; margin-top:10px; }
.alert{ padding:10px 12px; border-radius:12px; margin:8px 0; }
.alert.error{ background:#ffefef; color:#7f1d1d; border:1px solid #ffd3d3; }
.alert.ok{ background:#ecffef; color:#065f46; border:1px solid #bff7c7; }
.muted{ color:#6b7280; }

/* 右下角帳號/登出：固定藍/紅 */
.corner-actions{ position:fixed; right:18px; bottom:18px; z-index:50; display:flex; gap:8px; flex-wrap:wrap; }
.corner-actions .btn:first-child{
  background:var(--primary) !important; border-color:var(--primary) !important; color:#fff !important;
}
.corner-actions .btn.danger{
  background:var(--danger) !important; border-color:var(--danger) !important; color:#fff !important;
}

/* ============== 表格（統一 .table 與 table） ============== */
table, .table{
  width:100%;
  border-collapse:collapse !important;
  background:#fff !important;
  border:1px solid var(--line-soft) !important;
  border-radius:14px;
  overflow:hidden;
  box-shadow:0 12px 24px rgba(15,23,42,.06);
  table-layout:fixed !important;
}
table th, table td, .table th, .table td{
  padding:10px 12px !important;
  line-height:1.25 !important;
  font-size:15px;
  border:1px solid var(--line-soft) !important;
  text-align:center;
  overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
}
table thead th, .table thead th{
  position:sticky; top:0; z-index:1;
  background:linear-gradient(180deg,#ffffff,#f7fbff) !important;
  font-weight:800;
}
tr:hover td{ background:rgba(0,0,0,.03) !important; }
table tbody tr:nth-child(even) td:not(.shift-morning):not(.shift-night){ background:#fbfcff; }
table th:last-child, table td:last-child{ width:56px; text-align:center; }

/* 可編輯 */
td.editable{ cursor:pointer; position:relative; }
td.editable:hover{ box-shadow:inset 0 0 0 2px #cfe0ff; border-radius:8px; }
.cell-editor{
  width:100%; height:36px; border:1px solid var(--line);
  border-radius:8px; padding:0 8px; text-align:center;
}

/* ============== Checkbox：小正方形＋紅勾白底（唯一樣式） ============== */
input[type="checkbox"]{
  -webkit-appearance:none !important;
  appearance:none !important;
  /* 正方形關鍵 */
  aspect-ratio:1 / 1 !important;
  width:14px !important;
  height:14px !important;
  padding:0 !important;
  margin:0 !important;

  border:1.8px solid var(--line) !important;
  border-radius:2px !important;
  background:#fff !important;

  display:inline-grid !important; place-content:center !important;
  vertical-align:middle !important; box-shadow:none !important; line-height:normal !important;
}
input[type="checkbox"]::after{
  content:""; width:6px; height:9px;
  border-right:2px solid #D33; border-bottom:2px solid #D33;
  transform:rotate(45deg) translate(0,-1px);
  opacity:0; transition:opacity .05s linear;
}
input[type="checkbox"]:checked::after{ opacity:1; }
input[type="checkbox"]:focus-visible{ outline:2px solid #cfe0ff; outline-offset:2px; }

/* 讓整格看起來可點（不改行為） */
td:has(input[type="checkbox"]){ cursor:pointer; }

/* ============== KPI（彩色卡片） ============== */
.kpi-wrap{ display:grid; grid-template-columns:repeat(4,minmax(220px,1fr)); gap:24px; }
.kpi-card{
  position:relative; display:grid; grid-template-rows:auto 1fr;
  padding:14px 16px 18px;
  border:1px solid var(--line-soft); border-radius:18px;
  box-shadow:0 10px 24px rgba(15,23,42,.06); overflow:hidden;
}
.kpi-card .kpi-head{
  background:transparent; border:0; border-radius:0;
  padding:6px 8px 0 8px; font-weight:800; display:flex; align-items:center; gap:8px;
}
.kpi-card .kpi-value{
  background:transparent; border:0; border-radius:0;
  margin-top:8px; padding:18px 14px; min-height:130px;
  display:flex; align-items:center; justify-content:center;
  font-size:54px; font-weight:900; color:var(--text); text-align:center;
  box-shadow:inset 0 1px 0 rgba(255,255,255,.35);
}
.kpi-card.kpi-morning{
  background:
    radial-gradient(600px 140px at 15% -10%, rgba(255,255,255,.45), transparent 60%),
    radial-gradient(600px 140px at 85% 110%, rgba(255,255,255,.25), transparent 60%),
    linear-gradient(135deg, #FFF1BF 0%, #FFE08C 100%);
}
.kpi-card.kpi-night{
  background:
    radial-gradient(600px 140px at 15% -10%, rgba(255,255,255,.45), transparent 60%),
    radial-gradient(600px 140px at 85% 110%, rgba(255,255,255,.25), transparent 60%),
    linear-gradient(135deg, #E6EAFF 0%, #CCD6FF 100%);
}
.kpi-card.kpi-expense{
  background:
    radial-gradient(600px 140px at 15% -10%, rgba(255,255,255,.45), transparent 60%),
    radial-gradient(600px 140px at 85% 110%, rgba(255,255,255,.25), transparent 60%),
    linear-gradient(135deg, #FFDADF 0%, #FFC3CC 100%);
}
.kpi-card.kpi-total{
  background:
    radial-gradient(600px 140px at 15% -10%, rgba(255,255,255,.45), transparent 60%),
    radial-gradient(600px 140px at 85% 110%, rgba(255,255,255,.25), transparent 60%),
    linear-gradient(135deg, #EAFEF2 0%, #D0F7DE 100%);
}
.kpi-card.kpi-net{
  grid-column:1 / -1; justify-self:center; max-width:920px;
  border:1px solid var(--line); border-radius:18px;
  background:
    radial-gradient(600px 140px at 15% -10%, rgba(255,255,255,.45), transparent 60%),
    radial-gradient(600px 140px at 85% 110%, rgba(255,255,255,.25), transparent 60%),
    linear-gradient(135deg,#EDE6FF 0%, #D8CEFF 100%);
}
.kpi-card.kpi-net .kpi-head{ justify-content:center; }
.kpi-card.kpi-net .kpi-value{
  margin-top:0; min-height:auto; padding:28px 24px;
  display:flex; align-items:center; justify-content:flex-start; gap:8px;
  font-size:64px; text-align:left;
}
.kpi-card.kpi-net .kpi-value .cur{ font-size:.55em; opacity:.85; }

/* ============== 訂單：班別著色 ============== */
select.shift-select{
  background:linear-gradient(180deg, rgba(255,255,255,.96), rgba(255,255,255,.86));
  border:1px solid var(--line); border-radius:12px;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.9),
    inset 0 -1px 0 rgba(0,0,0,.04),
    0 6px 14px rgba(15,23,42,.06);
}
select.shift-select.is-morning{
  background:linear-gradient(180deg, #FFF5C9 0%, #FFE28E 100%) !important;
  border-color:#EED48A !important;
}
select.shift-select.is-night{
  background:linear-gradient(180deg, #EAF0FF 0%, #CFDBFF 100%) !important;
  border-color:#C2D0FF !important;
}
td.shift-morning{
  background:linear-gradient(180deg, var(--gold-50) 0%, var(--gold-100) 100%) !important;
  -webkit-user-select:none; user-select:none;
}
td.shift-night{
  background:linear-gradient(180deg, var(--blue-50) 0%, var(--blue-100) 100%) !important;
  -webkit-user-select:none; user-select:none;
}
td.shift-morning::selection, td.shift-night::selection,
td.shift-morning *::selection, td.shift-night *::selection{ background:transparent !important; }
tr:hover td:not(.shift-morning):not(.shift-night){ background:rgba(0,0,0,.03) !important; }

/* 匯出面板 */
.export-strip{ display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin-top:8px; }
.tile{
  display:flex; align-items:center; justify-content:center; height:56px;
  background:#fff; border:1px solid var(--line); border-radius:14px;
}
.tile.blue{ background:#eaf1ff; }
.tile.gold{ background:#fff7d6; }
.tile.green{ background:#e8fff3; }

/* 登入/帳號設定 */
.auth-only-card{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; }
.auth-card{
  width:520px; padding:22px 24px; background:#fff;
  border:1px solid var(--line); border-radius:18px; box-shadow:var(--shadow);
}
.account-page{ min-height:100vh; display:flex; align-items:center; justify-content:center; padding:24px; }
.account-card{ width:100%; max-width:720px; background:#fff; border:1px solid var(--line); border-radius:18px; box-shadow:var(--shadow); padding:22px; }
.account-form .row{ display:flex; flex-direction:column; gap:6px; margin-bottom:14px; }
.account-actions{ display:flex; justify-content:flex-end; gap:10px; margin-top:8px; }
.btn.save-red{ background:#ef4444; border-color:#ef4444; color:#fff; }

/* 表頭 badge（⇅ 提示） */
.th-badge{ display:inline-block; font-size:12px; opacity:.75; margin-left:6px; user-select:none; }

/* 滾動定位與 RWD */
.toolbar{ scroll-margin-top:8px; }
@media (max-width:900px){
  .export-strip{ grid-template-columns:1fr; }
  .kpi-wrap{ grid-template-columns:repeat(2,1fr); }
  .corner-actions{ right:12px; bottom:12px; }
}
@media (max-width:560px){
  .kpi-wrap{ grid-template-columns:1fr; }
}
/* ===== [OVERRIDE] Orders: 班別格固定底色、hover 不反白、勾選格可點整格 ===== */

/* 只讓 hover 影響非班別欄 */
#orders-table tr:hover td:not(.shift-morning):not(.shift-night){
  background: rgba(0,0,0,.03) !important;
}

/* 班別欄固定色（與 JS class 對齊） */
#orders-body td[data-field="shift"].shift-morning{
  background: linear-gradient(180deg,#FFF1BF,#FFE08C) !important;
}
#orders-body td[data-field="shift"].shift-night{
  background: linear-gradient(180deg,#E6EAFF,#CCD6FF) !important;
}

/* 勾選欄位：置中、整格可點（仍保留點 checkbox 本體） */
#orders-table td:last-child{ text-align:center; cursor:pointer; }
#orders-table td:last-child input[type="checkbox"]{ pointer-events:auto; }

/* 小正方形 + 紅勾白底（統一唯一版本） */
input[type="checkbox"]{
  -webkit-appearance:none; appearance:none;
  width:14px; height:14px;
  border:1.8px solid var(--line,#E5D7B2);
  border-radius:2px; background:#fff;
  display:inline-grid; place-content:center; vertical-align:middle;
  box-shadow:none;
}
input[type="checkbox"]::after{
  content:""; width:6px; height:9px; opacity:0;
  border-right:2px solid #D33; border-bottom:2px solid #D33;
  transform:rotate(45deg) translate(0,-1px);
}
input[type="checkbox"]:checked::after{ opacity:1; }
/* ===== OVERRIDES (0910) ===== */

/* A) 訂單：班別欄固定色 + hover 不覆蓋 + 勾選格可點整格 */
#orders-table tr:hover td:not(.shift-morning):not(.shift-night){
  background: rgba(0,0,0,.03) !important;
}
#orders-body td[data-field="shift"].shift-morning{
  background: linear-gradient(180deg,#FFF1BF,#FFE08C) !important;
}
#orders-body td[data-field="shift"].shift-night{
  background: linear-gradient(180deg,#E6EAFF,#CCD6FF) !important;
}
#orders-table td:last-child{ text-align:center; cursor:pointer; }
#orders-table td:last-child input[type="checkbox"]{ pointer-events:auto; }

/* B) 小正方形 + 紅勾白底（唯一版本；登入頁/表格同樣式） */
input[type="checkbox"]{
  -webkit-appearance:none; appearance:none !important;
  width:14px; height:14px !important;
  border:1.8px solid var(--line, #E5D7B2) !important;
  border-radius:2px !important; background:#fff !important;
  display:inline-grid !important; place-content:center; vertical-align:middle;
  box-shadow:none !important; line-height:normal !important;
}
input[type="checkbox"]::after{
  content:""; width:6px; height:9px;
  border-right:2px solid #D33; border-bottom:2px solid #D33;
  transform:rotate(45deg) translate(0,-1px); opacity:0;
}
input[type="checkbox"]:checked::after{ opacity:1; }

/* C) KPI：「扣支出後」更寬＆字稍小、置中顯示 */
.kpi-wrap{ gap:24px; }
.kpi-card.kpi-net{
  grid-column: 1 / -1;                 /* 跨整列 */
  max-width: 1100px;                    /* 稍微更寬 */
  margin-left: auto; margin-right: auto;
}
.kpi-card.kpi-net .kpi-head{
  justify-content:center; font-size:16px;
}
.kpi-card.kpi-net .kpi-value{
  display:flex; align-items:center; gap:8px; justify-content:flex-start;
  padding: 24px 20px;
  text-align:left;
  font-size: 44px;                      /* 比之前小一點 */
}
.kpi-card.kpi-net .kpi-value .cur{ font-size:.6em; opacity:.8; }
/* ===== OVERRIDES (0910b) ===== */

/* 1) 訂單：班別欄固定底色 + hover 不覆蓋 + 勾選欄可點整格 */
#orders-table tr:hover td:not(.shift-morning):not(.shift-night){
  background: rgba(0,0,0,.03) !important;
}
#orders-body td[data-field="shift"].shift-morning{
  background: linear-gradient(180deg,#FFF1BF,#FFE08C) !important;
}
#orders-body td[data-field="shift"].shift-night{
  background: linear-gradient(180deg,#E6EAFF,#CCD6FF) !important;
}
#orders-table td:last-child{ text-align:center; cursor:pointer; }
#orders-table td:last-child input[type="checkbox"]{ pointer-events:auto; }

/* 2) Checkbox：小正方形 + 紅勾白底（全站一致） */
input[type="checkbox"]{
  -webkit-appearance:none; appearance:none !important;
  width:14px; height:14px !important;
  border:1.8px solid var(--line, #E5D7B2) !important;
  border-radius:2px !important; background:#fff !important;
  display:inline-grid !important; place-content:center; vertical-align:middle;
  box-shadow:none !important; line-height:normal !important;
}
input[type="checkbox"]::after{
  content:""; width:6px; height:9px;
  border-right:2px solid #D33; border-bottom:2px solid #D33;
  transform:rotate(45deg) translate(0,-1px); opacity:0;
}
input[type="checkbox"]:checked::after{ opacity:1; }

/* 3) KPI：扣支出後 = 橫向長方形、左右更寬、字體稍小 */
.kpi-wrap{ gap:24px; }
.kpi-card.kpi-net{
  grid-column: 1 / -1;        /* 跨整列 */
  width: 100%;
  max-width: none;             /* 取消先前的寬度限制 */
  margin-left:auto; margin-right:auto;
}
.kpi-card.kpi-net .kpi-head{
  justify-content:center; font-size:16px;
}
.kpi-card.kpi-net .kpi-value{
  display:flex; align-items:center; gap:8px; justify-content:flex-start;
  padding: 22px 24px;
  text-align:left;
  font-size: 42px;             /* 比其他 KPI 略小，符合你的需求 */
}
.kpi-card.kpi-net .kpi-value .cur{ font-size:.6em; opacity:.8 }
/* === drag-select safety & visuals === */
#orders-table td:last-child,
#expenses-table td:last-child{
  user-select: none;           /* 拖曳不會反白文字 */
}
#orders-table tr:hover td:not(.shift-morning):not(.shift-night),
#expenses-table tr:hover td{   /* 班別欄不受 hover 影響 */
  background: rgba(0,0,0,.03) !important;
}
/* === KPI：把「營收」（kpi-net）卡片的標題/金額置中 === */
.kpi-card.kpi-net .kpi-head{
  justify-content: center !important;
  text-align: center !important;
}

.kpi-card.kpi-net .kpi-value{
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  text-align: center !important;
}
/* === KPI 金額：單行顯示，避免換行影響量測 === */
.kpi-card .kpi-value{
  white-space: nowrap;
}
/* KPI 金額單行，不讓內容換行 */
.kpi-card .kpi-value{ white-space:nowrap; }

/* 營收卡的數字置中（不改卡片尺寸與布局） */
.kpi-card.kpi-net .kpi-value{ justify-content:center; }
/* ===== Mobile safe block (不影響桌面) ===== */
html { -webkit-text-size-adjust: 100%; }            /* iOS 不自動放大字 */
input, select, textarea { font-size: 16px; }        /* 避免 iOS 聚焦強制放大頁面 */

@media (max-width: 900px){
  .kpi-wrap{ grid-template-columns: repeat(2, minmax(220px,1fr)); }
  .kpi-card.kpi-net{ grid-column: 1 / -1; }        /* 營收卡跨一列 */
}
@media (max-width: 560px){
  .kpi-wrap{ grid-template-columns: 1fr; }
  .kpi-card .kpi-value{ font-size: 42px; }         /* 極小裝置基準字級（仍會被 autosize 再縮） */
}

/* 手機點選「選取」欄位更好點 */
.cb-cell label.cb-hit{ min-height: 36px; }

/* Android 點擊時的水波/高亮不要干擾 */
* { -webkit-tap-highlight-color: rgba(0,0,0,0); }
