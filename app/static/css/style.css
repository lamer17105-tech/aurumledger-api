:root{
  --line:#e6d7a8; --shadow:0 10px 25px rgba(15,23,42,.06);
  --primary:#2f66f5; --danger:#ef4444; --bg:#f3f7ff;
}
*{box-sizing:border-box} html,body{margin:0;padding:0;background:#eef3fb;
  font-family:system-ui,-apple-system,"Segoe UI","Noto Sans TC","Microsoft JhengHei",sans-serif;color:#1f2937}
a{text-decoration:none;color:inherit}

.app{display:flex}
.sidebar{width:240px;background:#fff;border-right:1px solid var(--line);min-height:100vh}
.main{flex:1;min-height:100vh;background:#f6f9ff}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:10px 16px;border-bottom:1px solid var(--line);background:#edf5ff}
.content{padding:16px}
.content.tight{padding:18px}
.brand{padding:14px 12px 10px}
.nowrap{white-space:nowrap}
.brand-title{font-weight:900;font-size:18px}
.brand-sub{font-weight:800;color:#334155;margin-top:2px}
.nav{display:flex;flex-direction:column;padding:8px;gap:6px}
.nav-item{padding:10px 12px;border-radius:12px;margin:0 6px;border:1px solid transparent}
.nav-item:hover{background:#f2f6ff}
.nav-item.active{background:#eaf1ff;border-color:var(--line);font-weight:700}

.card{background:#fff;border:1px solid var(--line);border-radius:18px;padding:16px;box-shadow:var(--shadow);margin-bottom:16px}
.btn{display:inline-flex;align-items:center;justify-content:center;height:40px;padding:0 16px;border-radius:12px;border:1px solid var(--line);background:#fff;cursor:pointer}
.btn.primary{background:#2f66f5;color:#fff;border-color:#2f66f5}
.btn.danger{background:#ef4444;color:#fff;border-color:#ef4444}
.btn.pill{border-radius:999px}
/* 兼容舊標記 */
.btn-primary{background:#2f66f5;color:#fff;border-color:#2f66f5}

.input,input,select,textarea{height:40px;padding:0 12px;border:1px solid var(--line);border-radius:12px;background:#fff}
select{appearance:auto}

.table{width:100%;border-collapse:collapse;background:#fff}
.table th,.table td{padding:12px;border:1px solid var(--line);text-align:center}
.table th{background:#f8fbff;color:#15223b}

.alert{padding:10px 12px;border-radius:12px;margin:8px 0}
.alert.error{background:#ffefef;color:#7f1d1d;border:1px solid #ffd3d3}
.alert.ok{background:#ecffef;color:#065f46;border:1px solid #bff7c7}
.muted{color:#6b7280}

.card, .table, .table th, .table td, .input, input, select, textarea{border-color:var(--line)!important}

/* 登入中心 */
.app.auth-only .sidebar,.app.auth-only .topbar{display:none}
.app.auth-only .main{margin-left:0}
.content.auth-center{padding:0}
.auth-only-card{position:fixed;inset:0;display:flex;align-items:center;justify-content:center}
.auth-card{width:520px;border:1px solid var(--line);border-radius:18px;box-shadow:var(--shadow);background:#fff;padding:22px 24px}

/* 橫列表單 */
.toolbar{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.toolbar .row{display:flex;align-items:center;gap:8px}
.toolbar.order-create{background:#fffdf4}
.toolbar.order-create .row label{font-weight:700;color:#22315c}

/* 可編輯表格 */
td.editable{cursor:pointer}
td.editable:hover{box-shadow: inset 0 0 0 2px #cfe0ff;border-radius:8px}
.cell-editor{width:100%;height:36px;border:1px solid var(--line);border-radius:8px;padding:0 8px;text-align:center}
.center{text-align:center}

/* KPI（對齊你的圖） */
.kpi-head{background:#eaf3ff}
.kpi-grid-4{display:grid;grid-template-columns:repeat(4,minmax(240px,1fr));gap:18px}
.kpi-mini{border:1px solid var(--line);border-radius:18px;padding:18px;font-weight:800}
.kpi-figure{border:1px solid var(--line);border-radius:18px;padding:28px;font-size:44px;font-weight:900;text-align:center;background:#fff}
.kpi-early{background:linear-gradient(180deg,#fff7d1,#ffe9a8)}
.kpi-late{background:linear-gradient(180deg,#e7edff,#d4dfff)}
.kpi-exp{background:linear-gradient(180deg,#ffe4e4,#ffd2d2)}
.kpi-total{background:linear-gradient(180deg,#e6fff2,#d6ffe9)}
.kpi-net{background:linear-gradient(180deg,#e6fff2,#d6ffe9)}
.kpi-num-early{grid-column:1}
.kpi-num-late{grid-column:2}
.kpi-num-exp{grid-column:3}
.kpi-num-total{grid-column:4}
.kpi-grid-4 .kpi-net{grid-column:1}
.kpi-grid-4 .kpi-num-net{grid-column:2 / span 3}

/* 匯出面板 */
.export-strip{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;margin-top:8px}
.tile{display:flex;align-items:center;justify-content:center;border:1px solid var(--line);border-radius:14px;height:56px;background:#fff}
.tile.blue{background:#eaf1ff}.tile.gold{background:#fff7d6}.tile.green{background:#e8fff3}

/* 版面微調避免擠字 */
.sidebar .nav-item{font-size:15px}
.main{padding-left:6px;padding-right:6px}
/* —— 導覽區品牌置中 —— */
.sidebar .brand{
  text-align: center;
}
.sidebar .brand-title{
  display: block;              /* 確保獨佔一行 */
}
.sidebar .brand-sub{
  display: block;              /* 置於標題正下方 */
  margin-top: 4px;             /* 與上方留點間距 */
}
/* 品牌點擊回訂單 */
.sidebar .brand-link{
  display:block;
  color:inherit;
  text-decoration:none;
  border-radius:12px;
  padding:14px 12px 10px; /* 與原 .brand 視覺一致 */
}
.sidebar .brand-link:hover{
  background:#f7faff;
}
/* ===== 訂單表格：緊湊可讀版 ===== */
.table--orders{
  font-size: 14px;
  line-height: 1.35;
  table-layout: fixed;              /* 固定欄寬，避免大空洞 */
  font-variant-numeric: tabular-nums;
}
.table--orders th,
.table--orders td{
  padding: 6px 8px;                 /* 由 12px -> 6~8px，縮小行高 */
  white-space: nowrap;              /* 不換行，避免撐高 */
}

/* 欄寬配置（依你的欄位順序） */
.table--orders th:nth-child(1), .table--orders td:nth-child(1){ width: 64px; }   /* 班別 */
.table--orders th:nth-child(2), .table--orders td:nth-child(2){ width: 88px; }   /* 單號 */
.table--orders th:nth-child(3), .table--orders td:nth-child(3){ width: 96px; }   /* 金額 */
.table--orders th:nth-child(4), .table--orders td:nth-child(4){ width: 136px; }  /* 日期 */
.table--orders th:nth-child(5), .table--orders td:nth-child(5){ width: 72px; }   /* 選取 */

/* 條紋＋懸停強調，提高可讀性 */
.table--orders tbody tr:nth-child(even){ background:#fafcff; }
.table--orders tbody tr:hover{ background:#f0f6ff; }

/* 編輯輸入框也跟著縮小，維持行高一致 */
.table--orders .cell-editor{
  height: 32px;                     /* 原 36px -> 32px */
  padding: 0 6px;
}

/* 勾選框微縮，避免撐高 */
.table--orders input[type="checkbox"]{
  transform: scale(0.9);
}

/* 小螢幕再緊一點 */
@media (max-width: 768px){
  .table--orders{ font-size: 13px; }
  .table--orders th, .table--orders td{ padding: 5px 6px; }
}
/* 勾選框：白底＋紅勾（廣泛支援 browsers 的簡化方案） */
.table--orders input[type="checkbox"]{
  width: 16px; height: 16px;
  accent-color: #ef4444;          /* 勾選顏色紅 */
  background-color: #ffffff;      /* 底白 */
  border: 1px solid var(--line);
  transform: scale(0.95);
}

/* 讓內嵌 select 高度與行高一致、字置中 */
.table--orders select.cell-editor{
  height: 32px;
  padding: 0 6px;
  text-align-last: center;        /* 某些瀏覽器需此屬性置中文字 */
}
/* ===== 右下角浮動操作區 ===== */
.floating-actions{
  position: fixed; right: 16px; bottom: 16px;
  display: flex; gap: 10px; z-index: 1000;
}

/* ===== 整體縱向緊湊化（把框架往上、縮距） ===== */
.content.tight{ padding: 10px !important; }                 /* 原 18 -> 10 */
.content .card:first-child{ margin-top: 4px !important; }   /* 首卡更貼近頂部 */
.card{ margin-bottom: 12px !important; }                    /* 原 16 -> 12 */
.toolbar{ gap: 8px !important; }                            /* 原 12 -> 8 */

/* ===== 「刪除選中」與表格保持距離（所有頁面） ===== */
.actionbar{ margin-top: 10px; }

/* ===== 訂單表：已緊縮；再微調讓更好讀 ===== */
.table--orders th, .table--orders td{ padding: 6px 8px; }
.table--orders .cell-editor{ height: 32px; padding: 0 6px; }

/* ===== 支出頁：表格緊湊可讀版 ===== */
.table--expenses{
  font-size: 14px; line-height: 1.35; table-layout: fixed;
  font-variant-numeric: tabular-nums;
}
.table--expenses th, .table--expenses td{ padding: 6px 8px; white-space: nowrap; }
.table--expenses th:nth-child(1), .table--expenses td:nth-child(1){ width: 140px; } /* 分類 */
.table--expenses th:nth-child(2), .table--expenses td:nth-child(2){ width: 110px; } /* 金額 */
.table--expenses th:nth-child(3), .table--expenses td:nth-child(3){ width: 136px; } /* 日期 */
.table--expenses th:nth-child(4), .table--expenses td:nth-child(4){ width: auto; }  /* 備註(自動) */
.table--expenses th:nth-child(5), .table--expenses td:nth-child(5){ width: 72px; }  /* 選取 */
.table--expenses tbody tr:nth-child(even){ background:#fafcff; }
.table--expenses tbody tr:hover{ background:#f0f6ff; }

/* ===== 讓工具列卡片更薄（你圖中的兩條） ===== */
.card.toolbar{ padding: 12px 14px !important; }             /* 原 16 -> 12 */
.toolbar.order-create{ background:#fffdf4; }                 /* 保留原色，但同樣較薄 */

/* ===== 細節：checkbox 與邊線距離、外觀一致 ===== */
.table input[type="checkbox"]{ transform: scale(0.95); }
/* ===== 支出頁：讓搜尋按鈕與欄位同排 ===== */
@media (min-width: 1100px){                  /* 桌面寬度以上固定同一行 */
  .toolbar--range form.row{
    display: flex;
    align-items: center;
    flex-wrap: nowrap !important;            /* 不換行 */
    gap: 8px;                                /* 縮小間距 */
  }
  /* 壓縮欄位寬度，騰出空間給按鈕 */
  .toolbar--range form.row input[type="date"]{ width: 130px; }
  .toolbar--range form.row input[type="text"][name="q"]{
    width: 220px; min-width: 180px;
  }
  /* 搜尋按鈕固定尺寸、不被擠縮 */
  .toolbar--range form.row button[type="submit"]{
    flex: 0 0 auto;
    margin-left: 6px;
  }
  /* 標籤不斷行，避免撐高 */
  .toolbar--range form.row .label{ white-space: nowrap; }
}

/* 手機／較小視窗維持可換行（預設），但把間距再縮一點更順眼 */
@media (max-width: 1099px){
  .toolbar--range form.row{ gap: 6px; }
}
/* ===== 讓所有頁面上移，與左側 LOGO 上方那條線對齊 ===== */
/* 把 topbar 壓成一條細線 */
.topbar{
  padding: 0 12px !important;
  height: 8px !important;          /* 細線高度 */
  min-height: 8px !important;
  background: #edf5ff;             /* 與現有配色一致 */
  border-bottom: 1px solid var(--line);
}

/* 主內容更貼上緣 */
.content.tight{ padding-top: 6px !important; }   /* 原本較大，改小 */
.content .card:first-child{ margin-top: 2px !important; }  /* 第一張卡幾乎貼齊 */

/* 右下角浮動鈕不擋內容（保險） */
.floating-actions{ bottom: 14px !important; right: 14px !important; }
/* —— 讓第一張卡片與上方線完全貼齊／蓋上 —— */

/* 1) topbar 只保留 1px 邊線，取消高度與內距 */
.topbar{
  height: 0 !important;
  min-height: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  border-bottom: 1px solid var(--line) !important;
}

/* 2) 主內容去掉上方內距 */
.content.tight{ padding-top: 0 !important; }

/* 3) 第一張卡片往上吃 1px，把 topbar 的線蓋掉 */
.content .card:first-child{
  margin-top: -1px !important;   /* 覆蓋那條線 */
  position: relative; z-index: 2; /* 確保畫在最上層 */
}
/* ===== 頂部細線與內容：智慧間距（全站） ===== */
/* 仍保留 1px 上方分隔線，但內容不上貼，留一點空氣感 */
.topbar{
  height: 0 !important;
  min-height: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  border-bottom: 1px solid var(--line) !important;
}

/* 基準間距（桌機 10px / 平板 8px / 手機 6px） */
.content.tight{ padding-top: 10px !important; }
@media (max-width: 1199px){ .content.tight{ padding-top: 8px !important; } }
@media (max-width: 767px){  .content.tight{ padding-top: 6px !important; } }

/* 取消先前的 -1px 蓋線與提層，改為自然留白 */
.content .card:first-child{
  margin-top: 0 !important;
  position: static !important;
  z-index: auto !important;
}
/* ===== 取消頂部那條金色線（只移除 topbar 的底線）===== */
.topbar{
  display: none !important;        /* 直接隱藏 topbar 與其邊線 */
}

/* 頂部留一點舒服間距，所有頁面一致 */
.content.tight{ padding-top: 10px !important; }  /* 需要更緊可改 6~8px */

/* 避免之前覆蓋線用到的負邊距/提層殘留 */
.content .card:first-child{
  margin-top: 0 !important;
  position: static !important;
  z-index: auto !important;
}
/* ===== KPI：數字方塊與標題色塊對色 ===== */
/* 早班 → 黃系 */
.kpi-num-early{
  background: linear-gradient(180deg,#fff7d1,#ffe9a8) !important;
  border-color: #f2d68c !important;
}
/* 晚班 → 藍系 */
.kpi-num-late{
  background: linear-gradient(180deg,#e7edff,#d4dfff) !important;
  border-color: #c8d4ff !important;
}
/* 支出 → 粉紅系 */
.kpi-num-exp{
  background: linear-gradient(180deg,#ffe4e4,#ffd2d2) !important;
  border-color: #f3bebe !important;
}
/* 總額／扣支出後 → 綠系 */
.kpi-num-total,
.kpi-num-net{
  background: linear-gradient(180deg,#e6fff2,#d6ffe9) !important;
  border-color: #bfead4 !important;
}

/* 文字對比度、陰影一致 */
.kpi-figure{
  color:#0f172a;                 /* 深色字更好讀 */
  box-shadow: var(--shadow);
}
/* ===== KPI：扣支出後 改用淺紫色，避免與總額混色 ===== */
.kpi-net{
  background: linear-gradient(180deg,#efe1ff,#dec9ff) !important; /* 小標色塊 */
  border-color: #d2baff !important;
}
.kpi-num-net{
  background: linear-gradient(180deg,#f0e7ff,#dbcaff) !important; /* 大數字方塊 */
  border-color: #c9b3ff !important;
  color:#0f172a;  /* 深色字，對比清楚 */
}
/* 登入頁品牌樣式（置中、兩行） */
.auth-card .login-brand{ text-align:center; margin-bottom:14px; }
.login-brand .row1{ display:flex; align-items:center; justify-content:center; gap:8px; }
.login-brand .logo-emoji{ font-size:22px; line-height:1; }
.login-brand .title{ font-weight:900; font-size:22px; letter-spacing:.2px; }
.login-brand .title .strong{ font-weight:900; }
.login-brand .sub{ margin-top:4px; font-weight:800; color:#334155; }
/* ===== Login 外框強化（僅登入/首設/二次驗證頁會套用） ===== */

/* 1) 背景加柔和光暈，畫面不空但不干擾 */
.auth-only-card{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; }
.auth-only-card::before,
.auth-only-card::after{
  content:""; position:absolute; pointer-events:none; filter: blur(28px); opacity:.35;
}
.auth-only-card::before{ width:280px; height:280px; left:6%; top:8%;
  background: radial-gradient(120px 120px at 30% 30%, #cfe1ff, transparent 70%);
}
.auth-only-card::after{ width:320px; height:320px; right:6%; bottom:10%;
  background: radial-gradient(140px 140px at 70% 70%, #ffe9a8, transparent 75%);
}

/* 2) auth-card：漸層描邊 + 內外雙層框，質感提升 */
.auth-card{
  position:relative;
  border:1px solid transparent;            /* 由 ::before 畫真正的描邊 */
  border-radius:22px;
  background:#fff;
  box-shadow: 0 12px 30px rgba(15,23,42,.10);
  padding:26px 28px;
}
/* 漸層描邊（1px） */
.auth-card::before{
  content:""; position:absolute; inset:0; padding:1px; border-radius:22px;
  background: linear-gradient(135deg, #e6d7a8 0%, #bcd6ff 45%, #d6ffe9 100%);
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor; mask-composite:exclude; pointer-events:none;
}
/* 內層細框（0.5px） */
.auth-card::after{
  content:""; position:absolute; inset:6px; border-radius:16px;
  border:1px solid rgba(230,215,168,.55); pointer-events:none;
}

/* 3) 品牌區與表單細節（小分隔線 + 更緊湊） */
.auth-card .login-brand{ margin-bottom:12px; position:relative; }
.auth-card .login-brand::after{
  content:""; display:block; height:1px; background: var(--line); opacity:.8; margin-top:10px;
}
.auth-card form{ margin-top:8px; }
.auth-card .input, .auth-card select{
  height:42px; border-radius:12px;
}
.auth-card .btn.primary{
  height:42px; border-radius:12px;
  box-shadow: 0 6px 16px rgba(47,102,245,.25);
}
/* ===== Login 背景（僅登入/首設頁）：玫瑰金淡紋路 + 噪點 ===== */
.app.auth-only{
  /* 背景主體：玫瑰金系柔和漸層＋兩個光暈 */
  background:
    radial-gradient(720px 720px at 82% 86%, rgba(255, 190, 170, .22), transparent 60%),
    radial-gradient(560px 560px at 12% 18%, rgba(255, 210, 185, .18), transparent 58%),
    linear-gradient(180deg, #fff7f2 0%, #fff1e9 100%);
}

/* 細緻點陣紋路（極淡） + 極淡斜線，避免畫面太空 */
.app.auth-only::before{
  content:""; position: fixed; inset: 0; pointer-events: none;
  background-image:
    radial-gradient(rgba(255, 205, 195, .14) 1px, transparent 1px), /* 點陣 */
    repeating-linear-gradient(135deg, rgba(255, 210, 200, .05) 0 12px, rgba(255,255,255,.05) 12px 24px); /* 斜線 */
  background-size: 22px 22px, 28px 28px;
  opacity: .45;
}

/* 取消之前卡在登入頁的光暈裝飾，避免互撞（若無先前樣式，這行不影響） */
.auth-only-card::before, .auth-only-card::after{ display:none !important; }
/* ===== Login：全頁背板（不含中間卡片）— 玫瑰金系 ===== */
.app.auth-only{
  position: relative;
  /* 主背景：柔和玫瑰金漸層 + 兩側光暈 */
  background:
    radial-gradient(520px 520px at 85% 80%, rgba(255, 190, 170, .28), transparent 60%),
    radial-gradient(420px 420px at 15% 20%, rgba(255, 210, 185, .22), transparent 58%),
    linear-gradient(180deg, #fff3ee 0%, #fff7f3 100%);
}

/* 關掉 .main 的預設底色，讓背板露出來 */
.app.auth-only .main{
  background: transparent !important;
}

/* 細紋路（極淡斜紋 + 細點），只蓋在背板上，不影響卡片 */
.app.auth-only::before{
  content:"";
  position: fixed; inset: 0; pointer-events: none;
  background-image:
    radial-gradient(rgba(255, 205, 195, .10) 1px, transparent 1px),          /* 細點 */
    repeating-linear-gradient(135deg, rgba(255, 190, 170, .06) 0 14px, rgba(255,255,255,.06) 14px 28px); /* 斜紋 */
  background-size: 22px 22px, 28px 28px;
  opacity: .55;
  z-index: 0;
}

/* 之前為登入頁加的光暈若還在，關掉避免打架（沒有也沒關係） */
.auth-only-card::before, .auth-only-card::after{ display:none !important; }
/* ===== 玫瑰金背板：所有介面（登入頁除外），只在卡片之外顯示 ===== */
.app:not(.auth-only) .main{
  position: relative;
  /* 主底色 + 兩個柔和光暈 */
  background:
    radial-gradient(700px 700px at 85% 85%, rgba(255,190,170,.22), transparent 60%),
    radial-gradient(560px 560px at 12% 15%, rgba(255,210,185,.18), transparent 58%),
    linear-gradient(180deg, #fff3ee 0%, #fff7f3 100%) !important;
}

/* 加一層極淡紋理（點陣 + 斜紋），只鋪在背板上 */
.app:not(.auth-only) .main::before{
  content:"";
  position:absolute; inset:0; pointer-events:none;
  background-image:
    radial-gradient(rgba(255,205,195,.10) 1px, transparent 1px),            /* 細點 */
    repeating-linear-gradient(135deg, rgba(255,190,170,.06) 0 14px, rgba(255,255,255,.06) 14px 28px); /* 斜紋 */
  background-size:22px 22px, 28px 28px;
  opacity:.50;
  z-index:0;
}

/* 確保內容疊在紋理之上；卡片本身維持白底 */
.app:not(.auth-only) .content{ position: relative; z-index: 1; }
/* 表頭「整合」提示徽章（可排序） */
.table--orders th.sortable .th-badge{
  display:inline-block;
  margin-left:6px;
  padding:1px 6px;
  font-size:12px;
  line-height:18px;
  border-radius:999px;
  background:#eef3ff;
  border:1px solid var(--line);
  color:#22315c;
  opacity:.85;
}
.table--orders th.sortable:hover .th-badge{ opacity:1; box-shadow:var(--shadow); }
/* 紅勾白底（全站表格用） */
.table input[type="checkbox"]{
  accent-color: #ef4444;           /* 紅色勾勾 */
  background-color:#fff;           /* 白底 */
  width: 18px; height: 18px;
}

/* 支出表格與編輯輸入尺寸一致 */
.table--expenses th, .table--expenses td{ padding: 6px 8px; }
.table--expenses .cell-editor{ height: 32px; padding: 0 6px; text-align:center; }

/* 表頭徽章（沿用訂單頁風格） */
.table--expenses th.sortable .th-badge{
  display:inline-block; margin-left:6px; padding:0 6px;
  font-size:12px; line-height:18px; border-radius:999px;
  background:#eef3ff; border:1px solid var(--line); color:#22315c; opacity:.85;
}
.table--expenses th.sortable:hover .th-badge{ opacity:1; box-shadow:var(--shadow); }
/* 訂單新增：班別選單依值著色（早=金黃、晚=淡藍） */
.order-create .shift-select{
  border:1px solid var(--line);
  color:#1f2937;
  border-radius:12px;
  transition: background-color .15s ease, border-color .15s ease, color .15s ease;
}
.order-create .shift-select.shift-morning{
  background: linear-gradient(180deg,#fff7d6,#ffe9a8);
  border-color:#f2d68c;
}
.order-create .shift-select.shift-night{
  background: linear-gradient(180deg,#e7edff,#d4dfff);
  border-color:#c8d4ff;
}
.order-create .shift-select:focus{
  outline: none;
  box-shadow: 0 0 0 3px rgba(47,102,245,.15);
}
/* 表格班別欄著色（僅顯示用，不影響其他欄） */
.table--orders td.shift-morning{
  background: linear-gradient(180deg,#fff7d6,#ffe9a8);
  border-color:#f2d68c !important;
}
.table--orders td.shift-night{
  background: linear-gradient(180deg,#e7edff,#d4dfff);
  border-color:#c8d4ff !important;
}

