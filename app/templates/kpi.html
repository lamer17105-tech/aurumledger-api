{% extends "base.html" %}
{% block title %}ç‡Ÿæ¥­é¡{% endblock %}
{% block content %}

{# å°è¦½æ–‡å­— #}
{% set prev_label  = 'å‰ä¸€å¤©' if mode=='day' else ('å‰ä¸€æœˆ' if mode=='month' else 'å‰ä¸€å¹´') %}
{% set today_label = 'ä»Šæ—¥'   if mode=='day' else ('ä»Šæœˆ'   if mode=='month' else 'ä»Šå¹´') %}
{% set next_label  = 'å¾Œä¸€å¤©' if mode=='day' else ('å¾Œä¸€æœˆ' if mode=='month' else 'å¾Œä¸€å¹´') %}
{% set date_label  = 'æ—¥æœŸ'   if mode=='day' else ('æœˆä»½'   if mode=='month' else 'å¹´ä»½') %}

<!-- æ—¥æœŸå°è¦½ï¼ˆå’Œ base çš„è‡ªå‹•æäº¤é…å°ï¼š#range-form, #mode, #dtï¼‰ -->
<div class="card toolbar toolbar--range">
  <form id="range-form" method="get" action="/kpi" class="row">
    <label class="label">æ¨¡å¼</label>
    <select name="mode" id="mode">
      <option value="day"   {% if mode=='day' %}selected{% endif %}>ç•¶æ—¥</option>
      <option value="month" {% if mode=='month' %}selected{% endif %}>ç•¶æœˆ</option>
      <option value="year"  {% if mode=='year' %}selected{% endif %}>ç•¶å¹´</option>
    </select>

    <label class="label">{{ date_label }}</label>
    <input type="date" name="dt" id="dt" value="{{ dt }}">

    <a class="btn pill" href="/kpi?mode={{ mode }}&dt={{ nav.prev }}">â† {{ prev_label }}</a>
    <a class="btn pill primary" href="/kpi?mode={{ mode }}&dt={{ nav.today }}">{{ today_label }}</a>
    <a class="btn pill" href="/kpi?mode={{ mode }}&dt={{ nav.next }}">{{ next_label }} â†’</a>

    <span class="muted" style="margin-left:8px">æœŸé–“ï¼š{{ period }}</span>
  </form>
</div>

<!-- KPI å¡ç‰‡ -->
<section class="kpi-wrap">
  <article class="kpi-card kpi-morning">
    <div class="kpi-head">ğŸ“„ æ—©ç­</div>
    <div class="kpi-value">NT${{ k_early|money }}</div>
  </article>

  <article class="kpi-card kpi-night">
    <div class="kpi-head">ğŸŒ™ æ™šç­</div>
    <div class="kpi-value">NT${{ k_late|money }}</div>
  </article>

  <article class="kpi-card kpi-expense">
    <div class="kpi-head">ğŸ’³ æ”¯å‡º</div>
    <div class="kpi-value">NT${{ k_exp|money }}</div>
  </article>

  <article class="kpi-card kpi-total">
    <div class="kpi-head">ğŸ“Š ç¸½é¡</div>
    <div class="kpi-value">NT${{ k_total|money }}</div>
  </article>

  <!-- ä¾ä½ çš„éœ€æ±‚ï¼šæŠŠã€Œæ‰£æ”¯å‡ºå¾Œã€æ”¹ç‚ºã€Œç‡Ÿæ”¶ã€ï¼Œç½®ä¸­ä¸”æ©«å‘è¼ƒå¯¬ï¼ˆæ¨£å¼åœ¨ base è£¡å·²å°±ç·’ï¼‰ -->
  <article class="kpi-card kpi-net">
    <div class="kpi-head">âœ… ç‡Ÿæ”¶</div>
    <div class="kpi-value">
      <span class="cur">NT$</span><span class="amt">{{ k_net|money }}</span>
    </div>
  </article>
</section>

{% endblock %}
