{% extends "base.html" %}
{% block title %}營業額{% endblock %}
{% block content %}

{# 導覽文字 #}
{% set prev_label  = '前一天' if mode=='day' else ('前一月' if mode=='month' else '前一年') %}
{% set today_label = '今日'   if mode=='day' else ('今月'   if mode=='month' else '今年') %}
{% set next_label  = '後一天' if mode=='day' else ('後一月' if mode=='month' else '後一年') %}
{% set date_label  = '日期'   if mode=='day' else ('月份'   if mode=='month' else '年份') %}

<!-- 日期導覽（和 base 的自動提交配對：#range-form, #mode, #dt） -->
<div class="card toolbar toolbar--range">
  <form id="range-form" method="get" action="/kpi" class="row">
    <label class="label">模式</label>
    <select name="mode" id="mode">
      <option value="day"   {% if mode=='day' %}selected{% endif %}>當日</option>
      <option value="month" {% if mode=='month' %}selected{% endif %}>當月</option>
      <option value="year"  {% if mode=='year' %}selected{% endif %}>當年</option>
    </select>

    <label class="label">{{ date_label }}</label>
    <input type="date" name="dt" id="dt" value="{{ dt }}">

    <a class="btn pill" href="/kpi?mode={{ mode }}&dt={{ nav.prev }}">← {{ prev_label }}</a>
    <a class="btn pill primary" href="/kpi?mode={{ mode }}&dt={{ nav.today }}">{{ today_label }}</a>
    <a class="btn pill" href="/kpi?mode={{ mode }}&dt={{ nav.next }}">{{ next_label }} →</a>

    <span class="muted" style="margin-left:8px">期間：{{ period }}</span>
  </form>
</div>

<!-- KPI 卡片 -->
<section class="kpi-wrap">
  <article class="kpi-card kpi-morning">
    <div class="kpi-head">📄 早班</div>
    <div class="kpi-value">NT${{ k_early|money }}</div>
  </article>

  <article class="kpi-card kpi-night">
    <div class="kpi-head">🌙 晚班</div>
    <div class="kpi-value">NT${{ k_late|money }}</div>
  </article>

  <article class="kpi-card kpi-expense">
    <div class="kpi-head">💳 支出</div>
    <div class="kpi-value">NT${{ k_exp|money }}</div>
  </article>

  <article class="kpi-card kpi-total">
    <div class="kpi-head">📊 總額</div>
    <div class="kpi-value">NT${{ k_total|money }}</div>
  </article>

  <!-- 依你的需求：把「扣支出後」改為「營收」，置中且橫向較寬（樣式在 base 裡已就緒） -->
  <article class="kpi-card kpi-net">
    <div class="kpi-head">✅ 營收</div>
    <div class="kpi-value">
      <span class="cur">NT$</span><span class="amt">{{ k_net|money }}</span>
    </div>
  </article>
</section>

{% endblock %}
