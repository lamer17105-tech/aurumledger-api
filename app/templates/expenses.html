{% extends "base.html" %}
{% block title %}æ”¯å‡º{% endblock %}
{% block content %}

{% set prev_label  = 'å‰ä¸€å¤©' if mode=='day' else ('å‰ä¸€æœˆ' if mode=='month' else 'å‰ä¸€å¹´') %}
{% set today_label = 'ä»Šæ—¥'   if mode=='day' else ('ä»Šæœˆ'   if mode=='month' else 'ä»Šå¹´') %}
{% set next_label  = 'å¾Œä¸€å¤©' if mode=='day' else ('å¾Œä¸€æœˆ' if mode=='month' else 'å¾Œä¸€å¹´') %}
{% set date_label  = 'æ—¥æœŸ'   if mode=='day' else ('æœˆä»½'   if mode=='month' else 'å¹´ä»½') %}

<div class="card toolbar toolbar--range">
  <form id="range-form" method="get" action="/expenses" class="row">
    <label class="label">æ¨¡å¼</label>
    <select name="mode" id="mode">
      <option value="day"   {% if mode=='day' %}selected{% endif %}>ç•¶æ—¥</option>
      <option value="month" {% if mode=='month' %}selected{% endif %}>ç•¶æœˆ</option>
      <option value="year"  {% if mode=='year' %}selected{% endif %}>ç•¶å¹´</option>
    </select>

    <label class="label">{{ date_label }}</label>
    <input type="date" name="dt" id="dt" value="{{ dt }}">

    <a class="btn pill primary" href="/expenses?mode={{ mode }}&dt={{ nav.prev }}">â† {{ prev_label }}</a>
    <a class="btn pill primary" href="/expenses?mode={{ mode }}&dt={{ nav.today }}">{{ today_label }}</a>
    <a class="btn pill primary" href="/expenses?mode={{ mode }}&dt={{ nav.next }}">{{ next_label }} â†’</a>

    <span class="muted" style="margin-left:8px">æœŸé–“ï¼š{{ start }} ~ {{ end }}</span>
  </form>
</div>

<form class="card toolbar" method="get" action="/expenses" style="align-items:center">
  <input type="hidden" name="mode" value="{{ mode }}">
  <input type="hidden" name="dt" value="{{ dt }}">
  <label class="label">é—œéµå­—</label>
  <input class="input" type="text" name="q" value="{{ q }}" placeholder="æœå°‹åˆ†é¡æˆ–å‚™è¨»ï¼ˆæ¸…ç©º=å…¨éƒ¨ï¼‰">
  <label class="label">èµ·</label>
  <input class="input" type="date" name="start" value="{{ start }}">
  <label class="label">è¿„</label>
  <input class="input" type="date" name="end" value="{{ end }}">
  <button class="btn pill primary" type="submit">ğŸ” æœå°‹</button>
</form>

<form class="card toolbar" method="post" action="/expenses/create" id="form-create-exp">
  <div class="row"><label>æ—¥æœŸ</label><input class="input" type="date" name="odt" value="{{ dt }}"></div>
  <div class="row"><label>åˆ†é¡</label>
    <select class="input" name="cat" required>
      <option>åŸæ–™</option><option>ç§Ÿé‡‘</option><option>äººäº‹</option>
      <option>èœéŒ¢</option><option>é›œæ”¯</option><option>ç§Ÿé‡‘æ°´é›»</option><option>å…¶ä»–</option>
    </select>
  </div>
  <div class="row"><label>é‡‘é¡</label><input class="input" type="number" name="amount" step="1" placeholder="å¦‚ 1200" required></div>
  <div class="row" style="min-width:260px"><label>å‚™è¨»</label><input class="input" type="text" name="memo" placeholder="é¸å¡«"></div>
  <button class="btn btn-primary" type="submit">æ–°å¢</button>
</form>

<form method="post" action="/expenses/delete" id="form-delete-exp">
  <table class="table table--expenses" id="expenses-table">
    <colgroup>
      <col style="width:20%"><col style="width:20%"><col style="width:20%"><col style="width:20%"><col style="width:20%">
    </colgroup>
    <thead>
      <tr>
        <th class="center">åˆ†é¡</th>
        <th class="center">é‡‘é¡</th>
        <th class="center">æ—¥æœŸ</th>
        <th class="center">å‚™è¨»</th>
        <th class="center">é¸å–</th>
      </tr>
    </thead>
    <tbody id="expenses-body">
      {% for it in items %}
      <tr data-id="{{ it.id }}">
        <td class="center editable" data-field="cat">{{ it.cat }}</td>
        <td class="center editable" data-field="amount">{{ it.amount|money }}</td>
        <td class="center editable" data-field="odt">{{ it.odt }}</td>
        <td class="center editable" data-field="memo">{{ it.memo }}</td>
        <td class="center"><input type="checkbox" name="selected" value="{{ it.id }}"></td>
      </tr>
      {% endfor %}
      {% if not items %}<tr><td colspan="5" class="center muted">ç›®å‰æ²’æœ‰è³‡æ–™</td></tr>{% endif %}
    </tbody>
  </table>

  <div class="actionbar left">
    <button class="btn pill danger" type="submit">åˆªé™¤é¸ä¸­</button>
  </div>
</form>

{% endblock %}
