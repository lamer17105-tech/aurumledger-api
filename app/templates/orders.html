{% extends "base.html" %}
{% block title %}訂單{% endblock %}
{% block content %}

<!-- 搜尋條（橫向） -->
<form class="card toolbar" method="get" action="/orders">
  <label class="label">搜尋</label>
  <input class="input" type="text" name="q" value="{{ q }}" placeholder="搜尋單號或金額（清空=全部）">
  <label class="label">起</label>
  <input class="input" type="date" name="from_" value="{{ from_ }}">
  <label class="label">迄</label>
  <input class="input" type="date" name="to" value="{{ to }}">
  <button class="btn pill primary" type="submit">🔎 搜尋</button>
</form>

<!-- 新增（橫列） -->
<form class="card toolbar order-create" method="post" action="/orders/create" id="form-create">
  <div class="row"><label>日期</label><input type="date" name="odt" value="{{ today }}"></div>
  <div class="row"><label>班別</label>
    <select name="shift" class="shift-select"><option>早班</option><option>晚班</option></select>
  </div>
  <div class="row"><label>單號</label><input id="order_no_input" type="text" name="order_no" placeholder="如 10037 或 37" required></div>
  <div class="row"><label>金額</label><input type="number" name="amount" step="1" placeholder="如 2568" required></div>
  <button class="btn primary" type="submit">新增</button>
</form>

<!-- 刪除選中 -->
<form method="post" action="/orders/delete" id="form-delete">
  <table class="table table--orders" id="orders-table">
    <thead>
      <tr>
        <th class="center sortable" data-key="shift">
          <span class="th-label">班別</span>
          <span class="th-badge" title="可點擊排序／再點一次恢復" aria-label="可點擊排序">⇅</span>
        </th>
        <th class="center sortable" data-key="order_no">
          <span class="th-label">單號</span>
          <span class="th-badge" title="可點擊排序／再點一次恢復" aria-label="可點擊排序">⇅</span>
        </th>
        <th class="center sortable" data-key="amount">
          <span class="th-label">金額</span>
          <span class="th-badge" title="可點擊排序／再點一次恢復" aria-label="可點擊排序">⇅</span>
        </th>
        <th class="center sortable" data-key="odt">
          <span class="th-label">日期</span>
          <span class="th-badge" title="可點擊排序／再點一次恢復" aria-label="可點擊排序">⇅</span>
        </th>
        <th class="center">選取</th>
      </tr>
    </thead>
    <tbody id="orders-body">
      {% for o in orders %}
      <tr data-id="{{ o.id }}" data-idx="{{ o.idx }}">
        <td class="center editable" data-field="shift">{{ o.shift }}</td>
        <td class="center editable" data-field="order_no">{{ o.order_no }}</td>
        <td class="center editable" data-field="amount">{{ o.amount|money }}</td>
        <td class="center editable" data-field="odt">{{ o.odt }}</td>
        <td class="center"><input type="checkbox" name="selected" value="{{ o.id }}"></td>
      </tr>
      {% endfor %}
      {% if not orders %}<tr><td colspan="5" class="center muted">目前沒有資料</td></tr>{% endif %}
    </tbody>
  </table>

  <div class="actionbar left">
    <button class="btn pill danger" type="submit">刪除選中</button>
  </div>
</form>

{% endblock %}
